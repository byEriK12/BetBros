<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Unirse a un grupo público</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="bg-dark text-white">

<!-- NAVBAR igual que dashboard -->
<nav id="navbar" class="navbar navbar-expand-lg px-4 py-3 border-bottom border-secondary">
  <a class="navbar-brand d-flex align-items-center" href="dashboard.html">
    <img src="images/logos/logo_final.png" alt="Logo BetBros" width="70" height="70" class="me-2">
    <span>
      <span class="text-verde-betbros fw-bold">Bet</span><span class="text-white fw-bold">Bros</span>
    </span>
  </a>
  <div class="d-flex align-items-center ms-auto">
    <div class="dropdown me-3">
      <span class="fw-bold text-verde-betbros">Bienvenid@,</span>
      <a href="#" class="dropdown-toggle text-white text-decoration-none fw-bold" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <span id="welcomeUser"></span>
      </a>
      <ul class="dropdown-menu dropdown-menu-end">
        <li><a class="dropdown-item" href="createPrivGroup.html">Crear grupo privado</a></li>
        <li><a class="dropdown-item" href="joinPrivGroup.html">Unirse a grupo privado</a></li>
        <li><a class="dropdown-item" href="joinPubGroup.html">Unirse a grupo público</a></li>
        <li><a class="dropdown-item" href="myGroups.html">Mis grupos</a></li>
        <li><a class="dropdown-item" href="configuration.html">Configuración</a></li>
        <li><a class="dropdown-item" href="#" onclick="logout()">Cerrar sesión</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mt-5 bg-dark rounded-4 p-4 shadow-lg">
  <!-- Título -->
  <h2 class="text-center text-verde-betbros fw-bold mb-4">Únete a un grupo público</h2>

  <!-- Barra de búsqueda -->
  <div class="d-flex justify-content-center mb-5">
    <div class="input-group w-75 w-md-50">
      <input type="text" id="searchGroupInput" class="form-control bg-dark text-white border-success" placeholder="Buscar grupos públicos...">
      <span class="input-group-text bg-success text-white"><i class="bi bi-search"></i></span>
    </div>
  </div>

  <!-- Contenedor de resultados filtrados -->
  <div id="filteredGroups" class="row g-4 justify-content-center d-none"></div>

  <!-- Secciones por defecto -->
  <div id="defaultGroups">
    <!-- Top Grupos -->
    <h4 class="text-center text-verde-betbros mb-3">Top Grupos</h4>
    <div id="topGroupsList" class="row g-4 justify-content-center"></div>

    <!-- Todos los Grupos -->
    <h4 class="text-center text-verde-betbros mt-5 mb-3">Todos los grupos</h4>
    <div id="allGroupsList" class="row g-4 justify-content-center"></div>
  </div>

  <!-- Botón de volver -->
  <div class="text-center mt-5">
    <button class="btn btn-outline-light btn-lg px-4" onclick="goTo('dashboard.html')">Volver al inicio</button>
  </div>
</div>

<script>
  const publicGroups = [
    { name: "Apuestas Champions", image: "images/groups/champions.png", members: 124, bets: 37 },
    { name: "Liga Española", image: "images/groups/laliga.png", members: 89, bets: 22 },
    { name: "NBA Fans", image: "images/groups/nba.png", members: 56, bets: 15 },
    { name: "Premier League", image: "images/groups/premier.png", members: 102, bets: 29 },
    { name: "Grupo Fútbol", image: "images/groups/futbol.png", members: 75, bets: 18 },
    { name: "Grupo NBA", image: "images/groups/nba2.png", members: 42, bets: 9 }
  ];

  function createGroupCard(group) {
    return `
      <div class="col-md-6 col-lg-4 public-group-list-item">
        <div class="card h-100 shadow-lg border border-success">
          <img src="${group.image}" class="card-img-top" alt="${group.name}" style="height:180px;object-fit:cover;">
          <div class="card-body d-flex flex-column bg-dark text-white">
            <h5 class="card-title fw-bold">${group.name}</h5>
            <p class="card-text mb-1"><strong>Personas:</strong> ${group.members}</p>
            <p class="card-text mb-3"><strong>Apuestas:</strong> ${group.bets}</p>
            <button class="btn btn-success mt-auto w-100 join-group-button" data-group-name="${group.name}">Unirse</button>
          </div>
        </div>
      </div>`;
  }

  function renderGroups() {
    const topGroups = publicGroups.slice(0, 3);
    const allGroups = publicGroups.slice(3, 6);

    document.getElementById('topGroupsList').innerHTML = topGroups.map(createGroupCard).join('');
    document.getElementById('allGroupsList').innerHTML = allGroups.map(createGroupCard).join('');
  }

  function filterGroups(query) {
    return publicGroups.filter(group => group.name.toLowerCase().includes(query.toLowerCase()));
  }

  document.getElementById('searchGroupInput').addEventListener('input', function() {
    const query = this.value.trim();
    const defaultSection = document.getElementById('defaultGroups');
    const filteredSection = document.getElementById('filteredGroups');

    if (query === '') {
      defaultSection.classList.remove('d-none');
      filteredSection.classList.add('d-none');
    } else {
      const results = filterGroups(query);
      filteredSection.innerHTML = results.map(createGroupCard).join('');
      defaultSection.classList.add('d-none');
      filteredSection.classList.remove('d-none');
    }
  });

  document.addEventListener('click', function(event) {
    if (event.target.classList.contains('join-group-button')) {
      const groupName = event.target.getAttribute('data-group-name');
      alert(`¡Te has unido al grupo "${groupName}"!`);
    }
  });

  document.addEventListener('DOMContentLoaded', renderGroups);
</script>
<script src="scripts/main.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</body>
</html>
